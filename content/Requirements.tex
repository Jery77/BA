% !TeX spellcheck = de_DE

\chapter{Requirements}
\label{chap:req}


\if 0
В рамках данной работы нужно разработать фреймворк, устраняющий внешние зависимости в CSAR. 
Необходим инструмент, который может быстро находить и устранять внешние зависимости в тоска топологии. 
Для начала необходимо разработать минимальную конфигурацию, находящую все баш скрипты использующие менеджер пакотов apt-get и удаляющую из них команды установки пакета(apt-get install.. )
обработчик пакетов получив имя пакеты, загружает необходимый пакет, как и всё его дерево зависимостей. так же необходимо обновить топологию тоски, загрузив необходимые данные. 
для каждого пакета необходимо создать node template в соответствующей Service Template, для этого необходимы NodeType, NodeTypeImplementation, содержащий пакет (deployment artifact) и скрипт для уго установки(implementation artifact). 
Для поиска ServiceTemplate соответствующего определённому артефакту будет полезно использовать предобработку всей топологии тоски, находящую зависомости Скрипт-NodeType - Service Template для дальнейшего использования.

ФРеймворк должен быть легко расширяем, кроме базового баша, необходимо иметь возможность легко добавить дополнительные скриптовые языки и обрабтчики менеджеров пакетов к ним. как пример - aptitude для же испольщуемого языка баша, или новый язык, вроде шефа или энсибл.

Как доказательство правильности построенной топологии можно использовать winery, 
это инструмент для опэнтоски, с помощью которго можно отображать и редактировать CSAR архивы.

пример работа программы

0) распакова архива во временную директорию

1)предобработка архива
построение зависимостей скрипт-ноду-сервис
добавление своих файлов, зависимости и артифакты

2)обработка языками
все файлы архива необходимо пропустить через каждый язык, для установки принадлежности. например по расширению ".sh", для баш скриптов, или по внутренним файлам, для энсибл-архивов 

3) обработка для менеджерами пакетов
каждый файл принадлежащий определённому языку, необходимо пропустить через обработчики менеджеров пакетов для этого языка. 
как пример, все файлы принадлежащие языку баш (имеющие расширение .sh), нужно пропустить через обработчик apt-get и через обработчик aptitude.
обработчики менеджеров пакетов должны устранить внешние зависомости в файлах (удалить или закомментировать строки) и передать мэнеджеру пакетов данные о необходимом пакете и артефакте, его вызывающем

4) мэнеджер пакетов
Загружает пакет и создаёт скрипт для его установки. вызывает менеджер топологии для того пакета. рекурсивно повторяет для всех пакетов, необходимых для работы данного. 

5) менеджер топологии, получив имя пакета и источник вызова (скрипт или другой пакет) 
Создаёт соответствующие NodeType, NodeTypeImplementation, DeploymentArtifact, ImplementationArtifact. 
по заранее построенным связям находит ServicTemplate, дополняет его NOdeTemplate и Reference. 

6) завершение работы и упаковка архива
	
\fi
