% !TeX spellcheck = en_EN

\chapter{Requirements}
\label{chap:req}


\if 0
В рамках данной работы нужно разработать фреймворк, устраняющий внешние зависимости в CSAR. 
Необходим инструмент, который может быстро находить и устранять внешние зависимости в тоска топологии. 
Для начала необходимо разработать минимальную конфигурацию, находящую все баш скрипты использующие менеджер пакотов apt-get и удаляющую из них команды установки пакета(apt-get install.. )
далее необходимо загрузить необходимый пакет, как и всё его дерево зависимостей. так же необходимо обновить топологию тоски, загрузив необходимые данные. 
для каждого пакета необходимо создать node template в соответствующей Service Template, для этого необходимы NodeType, NodeTypeImplementation, содержащий пакет (deployment artifact) и скрипт для уго установки(implementation artifact). 
Для поиска ServiceTemplate соответствующего определённому артефакту будет полезно использовать предобработку всей топологии тоски, находящую зависомости Скрипт-NodeType - Service Template для дальнейшего использования.

ФРеймворк должен быть легко расширяем, кроме базового баша, необходимо иметь возможность легко добавить дополнительные скриптовые языки и обрабтчики менеджеров пакетов к ним. как пример - aptitude для же испольщуемого языка баша, или новый язык, вроде шефа или энсибл.

Как доказательство правильности построенной топологии можно использовать winery, 
это инструмент для опэнтоски, с помощью которго можно отображать и редактировать CSAR архивы.

пример работа программы
\fi
\section*{Stages of CSAR processing}
\begin{itemize}  
	\item Begin  \\
	To start the work over program need to become input CSAR name, output CSAR name, and architecture of target hardware. 
	Then input CSAR need to be extracted.
	\item Preprocessing\\
	During preprocessing stage, RR need to analyze internal references and build dependency three.
	Furthermore, common Tosca definitions for artifacts and  relations between packages need to be added.
	\item Processing with Languages
	Each file from CSAR need to be processed by each Language handler, described in RR, to determine belonging to this language.
	\item Processing with Packet Managers
	Each file belonging to the Language, must be processed by Packet Manager Handler to find and resolve external references.
	\item Package handling
	After Package Handler receives package name he must download the right package, create TOSCA Node, sends request to Topology Handler  and recursively repeats this actions for all dependent packages, creating Dependency Tree.
	\item Topology handling
	Topology Handler use information about internal references and dependencies to update TOSCA Topology and add downloaded packages and created nodes. 
	\item End
	To complete the work we need to update Meta-file and pack Date back to the CSAR.
	
\end{itemize}
\if 0
3) обработка для менеджерами пакетов
каждый файл принадлежащий определённому языку, необходимо пропустить через обработчики менеджеров пакетов для этого языка. 
как пример, все файлы принадлежащие языку баш (имеющие расширение .sh), нужно пропустить через обработчик apt-get и через обработчик aptitude.
обработчики менеджеров пакетов должны устранить внешние зависомости в файлах (удалить или закомментировать строки) и передать мэнеджеру пакетов данные о необходимом пакете и артефакте, его вызывающем

4) мэнеджер пакетов
Загружает пакет и создаёт скрипт для его установки. вызывает менеджер топологии для того пакета. рекурсивно повторяет для всех пакетов, необходимых для работы данного. 

5) менеджер топологии, по имя пакета и источник (скрипт или другой пакет) 
Создаёт соответствующие NodeType, NodeTypeImplementation, DeploymentArtifact, ImplementationArtifact. 
по заранее построенным связям находит ServicTemplate, дополняет его NOdeTemplate и Reference. 

6) завершение работы
Обновление метаданных и упаковка архива
	
\fi
